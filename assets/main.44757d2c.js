class L{constructor(e){this.properties=e!=null?e:[]}get(e){const t=this.properties.filter(r=>r.name===e).map(r=>r.value);if(t.length>1)throw new Error('Expected only one property to be named "'+e+'"');if(t.length!==0)return t[0]}getString(e){return this.getByType(e,"string")}getNumber(e){return this.getByType(e,"number")}getBoolean(e){return this.getByType(e,"boolean")}getByType(e,t){const r=this.get(e);if(r!==void 0){if(t!=="json"&&typeof r!==t)throw new Error('Expected property "'+e+'" to have type "'+t+'"');return r}}mustGetString(e){return this.mustGetByType(e,"string")}mustGetNumber(e){return this.mustGetByType(e,"number")}mustGetBoolean(e){return this.mustGetByType(e,"boolean")}mustGetByType(e,t){const r=this.get(e);if(r===void 0)throw new Error('Property "'+e+'" is missing');if(t!=="json"&&typeof r!==t)throw new Error('Expected property "'+e+'" to have type "'+t+'"');return r}getType(e){const t=this.properties.filter(r=>r.name===e).map(r=>r.type);if(t.length>1)throw new Error('Expected only one property to be named "'+e+'"');if(t.length!==0)return t[0]}}const D="https://unpkg.com/@workadventure/scripting-api-extra@1.4.5/dist";class oe{constructor(e){this.name=e.name,this.x=e.x,this.y=e.y,this.properties=new L(e.properties)}get isReadable(){const e=this.properties.getString("readableBy");return e?WA.player.tags.includes(e):!0}get isWritable(){const e=this.properties.getString("writableBy");return e?WA.player.tags.includes(e):!0}}function N(n){const e=n?"#"+n.join():"";WA.nav.openCoWebSite(D+"/configuration.html"+e)}async function ae(n,e){const t=await WA.room.getTiledMap(),r=new Map;return z(t.layers,r,n,e),r}function z(n,e,t,r){for(const o of n)if(o.type==="objectgroup"){for(const a of o.objects)if(a.type==="variable"||a.class==="variable"){if(!!t&&o.name!==t||!!r&&!r.includes(a.name))continue;e.set(a.name,new oe(a))}}else o.type==="group"&&z(o.layers,e,t,r)}let G;async function M(){return G===void 0&&(G=se()),G}async function se(){return ie(await WA.room.getTiledMap())}function ie(n){const e=new Map;return J(n.layers,"",e),e}function J(n,e,t){for(const r of n)r.type==="group"?J(r.layers,e+r.name+"/",t):(r.name=e+r.name,t.set(r.name,r))}async function ce(){const n=await M(),e=[];for(const t of n.values())if(t.type==="objectgroup")for(const r of t.objects)(r.type==="area"||r.class==="area")&&e.push(r);return e}function ue(n){let e=1/0,t=1/0,r=0,o=0;const a=n.data;if(typeof a=="string")throw new Error("Unsupported tile layer data stored as string instead of CSV");for(let s=0;s<n.height;s++)for(let i=0;i<n.width;i++)a[i+s*n.width]!==0&&(e=Math.min(e,i),o=Math.max(o,i),t=Math.min(t,s),r=Math.max(r,s));return{top:t,left:e,right:o+1,bottom:r+1}}function F(n){let e=1/0,t=1/0,r=0,o=0;for(const a of n){const s=ue(a);s.left<e&&(e=s.left),s.top<t&&(t=s.top),s.right>o&&(o=s.right),s.bottom>r&&(r=s.bottom)}return{top:t,left:e,right:o,bottom:r}}/*!
 * mustache.js - Logic-less {{mustache}} templates with JavaScript
 * http://github.com/janl/mustache.js
 */var le=Object.prototype.toString,C=Array.isArray||function(e){return le.call(e)==="[object Array]"};function U(n){return typeof n=="function"}function fe(n){return C(n)?"array":typeof n}function V(n){return n.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function Q(n,e){return n!=null&&typeof n=="object"&&e in n}function pe(n,e){return n!=null&&typeof n!="object"&&n.hasOwnProperty&&n.hasOwnProperty(e)}var ge=RegExp.prototype.test;function he(n,e){return ge.call(n,e)}var ye=/\S/;function de(n){return!he(ye,n)}var me={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"};function be(n){return String(n).replace(/[&<>"'`=\/]/g,function(t){return me[t]})}var Ae=/\s*/,We=/\s+/,q=/\s*=/,ve=/\s*\}/,Te=/#|\^|\/|>|\{|&|=|!/;function we(n,e){if(!n)return[];var t=!1,r=[],o=[],a=[],s=!1,i=!1,c="",l=0;function f(){if(s&&!i)for(;a.length;)delete o[a.pop()];else a=[];s=!1,i=!1}var y,m,R;function S(W){if(typeof W=="string"&&(W=W.split(We,2)),!C(W)||W.length!==2)throw new Error("Invalid tags: "+W);y=new RegExp(V(W[0])+"\\s*"),m=new RegExp("\\s*"+V(W[1])),R=new RegExp("\\s*"+V("}"+W[1]))}S(e||h.tags);for(var u=new k(n),b,g,d,P,I,v;!u.eos();){if(b=u.pos,d=u.scanUntil(y),d)for(var B=0,re=d.length;B<re;++B)P=d.charAt(B),de(P)?(a.push(o.length),c+=P):(i=!0,t=!0,c+=" "),o.push(["text",P,b,b+1]),b+=1,P===`
`&&(f(),c="",l=0,t=!1);if(!u.scan(y))break;if(s=!0,g=u.scan(Te)||"name",u.scan(Ae),g==="="?(d=u.scanUntil(q),u.scan(q),u.scanUntil(m)):g==="{"?(d=u.scanUntil(R),u.scan(ve),u.scanUntil(m),g="&"):d=u.scanUntil(m),!u.scan(m))throw new Error("Unclosed tag at "+u.pos);if(g==">"?I=[g,d,b,u.pos,c,l,t]:I=[g,d,b,u.pos],l++,o.push(I),g==="#"||g==="^")r.push(I);else if(g==="/"){if(v=r.pop(),!v)throw new Error('Unopened section "'+d+'" at '+b);if(v[1]!==d)throw new Error('Unclosed section "'+v[1]+'" at '+b)}else g==="name"||g==="{"||g==="&"?i=!0:g==="="&&S(d)}if(f(),v=r.pop(),v)throw new Error('Unclosed section "'+v[1]+'" at '+u.pos);return Se(Ce(o))}function Ce(n){for(var e=[],t,r,o=0,a=n.length;o<a;++o)t=n[o],t&&(t[0]==="text"&&r&&r[0]==="text"?(r[1]+=t[1],r[3]=t[3]):(e.push(t),r=t));return e}function Se(n){for(var e=[],t=e,r=[],o,a,s=0,i=n.length;s<i;++s)switch(o=n[s],o[0]){case"#":case"^":t.push(o),r.push(o),t=o[4]=[];break;case"/":a=r.pop(),a[5]=o[2],t=r.length>0?r[r.length-1][4]:e;break;default:t.push(o)}return e}function k(n){this.string=n,this.tail=n,this.pos=0}k.prototype.eos=function(){return this.tail===""};k.prototype.scan=function(e){var t=this.tail.match(e);if(!t||t.index!==0)return"";var r=t[0];return this.tail=this.tail.substring(r.length),this.pos+=r.length,r};k.prototype.scanUntil=function(e){var t=this.tail.search(e),r;switch(t){case-1:r=this.tail,this.tail="";break;case 0:r="";break;default:r=this.tail.substring(0,t),this.tail=this.tail.substring(t)}return this.pos+=r.length,r};function w(n,e){this.view=n,this.cache={".":this.view},this.parent=e}w.prototype.push=function(e){return new w(e,this)};w.prototype.lookup=function(e){var t=this.cache,r;if(t.hasOwnProperty(e))r=t[e];else{for(var o=this,a,s,i,c=!1;o;){if(e.indexOf(".")>0)for(a=o.view,s=e.split("."),i=0;a!=null&&i<s.length;)i===s.length-1&&(c=Q(a,s[i])||pe(a,s[i])),a=a[s[i++]];else a=o.view[e],c=Q(o.view,e);if(c){r=a;break}o=o.parent}t[e]=r}return U(r)&&(r=r.call(this.view)),r};function p(){this.templateCache={_cache:{},set:function(e,t){this._cache[e]=t},get:function(e){return this._cache[e]},clear:function(){this._cache={}}}}p.prototype.clearCache=function(){typeof this.templateCache!="undefined"&&this.templateCache.clear()};p.prototype.parse=function(e,t){var r=this.templateCache,o=e+":"+(t||h.tags).join(":"),a=typeof r!="undefined",s=a?r.get(o):void 0;return s==null&&(s=we(e,t),a&&r.set(o,s)),s};p.prototype.render=function(e,t,r,o){var a=this.getConfigTags(o),s=this.parse(e,a),i=t instanceof w?t:new w(t,void 0);return this.renderTokens(s,i,r,e,o)};p.prototype.renderTokens=function(e,t,r,o,a){for(var s="",i,c,l,f=0,y=e.length;f<y;++f)l=void 0,i=e[f],c=i[0],c==="#"?l=this.renderSection(i,t,r,o,a):c==="^"?l=this.renderInverted(i,t,r,o,a):c===">"?l=this.renderPartial(i,t,r,a):c==="&"?l=this.unescapedValue(i,t):c==="name"?l=this.escapedValue(i,t,a):c==="text"&&(l=this.rawValue(i)),l!==void 0&&(s+=l);return s};p.prototype.renderSection=function(e,t,r,o,a){var s=this,i="",c=t.lookup(e[1]);function l(m){return s.render(m,t,r,a)}if(!!c){if(C(c))for(var f=0,y=c.length;f<y;++f)i+=this.renderTokens(e[4],t.push(c[f]),r,o,a);else if(typeof c=="object"||typeof c=="string"||typeof c=="number")i+=this.renderTokens(e[4],t.push(c),r,o,a);else if(U(c)){if(typeof o!="string")throw new Error("Cannot use higher-order sections without the original template");c=c.call(t.view,o.slice(e[3],e[5]),l),c!=null&&(i+=c)}else i+=this.renderTokens(e[4],t,r,o,a);return i}};p.prototype.renderInverted=function(e,t,r,o,a){var s=t.lookup(e[1]);if(!s||C(s)&&s.length===0)return this.renderTokens(e[4],t,r,o,a)};p.prototype.indentPartial=function(e,t,r){for(var o=t.replace(/[^ \t]/g,""),a=e.split(`
`),s=0;s<a.length;s++)a[s].length&&(s>0||!r)&&(a[s]=o+a[s]);return a.join(`
`)};p.prototype.renderPartial=function(e,t,r,o){if(!!r){var a=this.getConfigTags(o),s=U(r)?r(e[1]):r[e[1]];if(s!=null){var i=e[6],c=e[5],l=e[4],f=s;c==0&&l&&(f=this.indentPartial(s,l,i));var y=this.parse(f,a);return this.renderTokens(y,t,r,f,o)}}};p.prototype.unescapedValue=function(e,t){var r=t.lookup(e[1]);if(r!=null)return r};p.prototype.escapedValue=function(e,t,r){var o=this.getConfigEscape(r)||h.escape,a=t.lookup(e[1]);if(a!=null)return typeof a=="number"&&o===h.escape?String(a):o(a)};p.prototype.rawValue=function(e){return e[1]};p.prototype.getConfigTags=function(e){return C(e)?e:e&&typeof e=="object"?e.tags:void 0};p.prototype.getConfigEscape=function(e){if(e&&typeof e=="object"&&!C(e))return e.escape};var h={name:"mustache.js",version:"4.2.0",tags:["{{","}}"],clearCache:void 0,escape:void 0,parse:void 0,render:void 0,Scanner:void 0,Context:void 0,Writer:void 0,set templateCache(n){E.templateCache=n},get templateCache(){return E.templateCache}},E=new p;h.clearCache=function(){return E.clearCache()};h.parse=function(e,t){return E.parse(e,t)};h.render=function(e,t,r,o){if(typeof e!="string")throw new TypeError('Invalid template! Template should be a "string" but "'+fe(e)+'" was given as the first argument for mustache#render(template, view, partials)');return E.render(e,t,r,o)};h.escape=be;h.Scanner=k;h.Context=w;h.Writer=p;class ee{constructor(e,t){this.template=e,this.state=t,this.ast=h.parse(e)}getValue(){return this.value===void 0&&(this.value=h.render(this.template,this.state)),this.value}onChange(e){const t=[];for(const r of this.getUsedVariables().values())t.push(this.state.onVariableChange(r).subscribe(()=>{const o=h.render(this.template,this.state);o!==this.value&&(this.value=o,e(this.value))}));return{unsubscribe:()=>{for(const r of t)r.unsubscribe()}}}isPureString(){return this.ast.length===0||this.ast.length===1&&this.ast[0][0]==="text"}getUsedVariables(){const e=new Set;return this.recursiveGetUsedVariables(this.ast,e),e}recursiveGetUsedVariables(e,t){for(const r of e){const o=r[0],a=r[1],s=r[4];["name","&","#","^"].includes(o)&&t.add(a),s!==void 0&&typeof s!="string"&&this.recursiveGetUsedVariables(s,t)}}}async function Pe(){var n;const e=await ce();for(const t of e){const r=(n=t.properties)!==null&&n!==void 0?n:[];for(const o of r){if(o.type==="int"||o.type==="bool"||o.type==="object"||typeof o.value!="string")continue;const a=new ee(o.value,WA.state);if(a.isPureString())continue;const s=a.getValue();await Y(t.name,o.name,s),a.onChange(async i=>{await Y(t.name,o.name,i)})}}}async function Le(){var n;const e=await M();for(const[t,r]of e.entries())if(r.type!=="objectgroup"){const o=(n=r.properties)!==null&&n!==void 0?n:[];for(const a of o){if(a.type==="int"||a.type==="bool"||a.type==="object"||typeof a.value!="string")continue;const s=new ee(a.value,WA.state);if(s.isPureString())continue;const i=s.getValue();$(t,a.name,i),s.onChange(c=>{$(t,a.name,c)})}}}async function Y(n,e,t){console.log(n),(await WA.room.area.get(n)).setProperty(e,t)}function $(n,e,t){WA.room.setProperty(n,e,t),e==="visible"&&(t?WA.room.showLayer(n):WA.room.hideLayer(n))}let j,K=0,_=0;function H(n){if(WA.state[n.name]){let e=n.properties.mustGetString("openLayer");for(const t of e.split(`
`))WA.room.showLayer(t);e=n.properties.mustGetString("closeLayer");for(const t of e.split(`
`))WA.room.hideLayer(t)}else{let e=n.properties.mustGetString("openLayer");for(const t of e.split(`
`))WA.room.hideLayer(t);e=n.properties.mustGetString("closeLayer");for(const t of e.split(`
`))WA.room.showLayer(t)}}function Ee(n){const e=n.properties.getString("openSound"),t=n.properties.getNumber("soundRadius");let r=1;if(t){const o=ne(n.properties.mustGetString("openLayer").split(`
`));if(o>t)return;r=1-o/t}e&&WA.sound.loadSound(e).play({volume:r})}function Me(n){const e=n.properties.getString("closeSound"),t=n.properties.getNumber("soundRadius");let r=1;if(t){const o=ne(n.properties.mustGetString("closeLayer").split(`
`));if(o>t)return;r=1-o/t}e&&WA.sound.loadSound(e).play({volume:r})}function te(n){return n.map(e=>j.get(e)).filter(e=>(e==null?void 0:e.type)==="tilelayer")}function ne(n){const e=te(n),t=F(e),r=((t.right-t.left)/2+t.left)*32,o=((t.bottom-t.top)/2+t.top)*32;return Math.sqrt(Math.pow(K-r,2)+Math.pow(_-o,2))}function ke(n){WA.state.onVariableChange(n.name).subscribe(()=>{WA.state[n.name]?Ee(n):Me(n),H(n)}),H(n)}function Re(n,e,t,r){const o=n.name;let a,s,i=!1;const c=t.getString("tag");let l=!0;c&&!WA.player.tags.includes(c)&&(l=!1);const f=!!c;function y(){var u;a&&a.remove(),a=WA.ui.displayActionMessage({message:(u=t.getString("closeTriggerMessage"))!==null&&u!==void 0?u:"Press SPACE to close the door",callback:()=>{WA.state[e.name]=!1,m()}})}function m(){var u;a&&a.remove(),a=WA.ui.displayActionMessage({message:(u=t.getString("openTriggerMessage"))!==null&&u!==void 0?u:"Press SPACE to open the door",callback:()=>{WA.state[e.name]=!0,y()}})}function R(u){const b=F(te(e.properties.mustGetString("closeLayer").split(`
`)));s=WA.room.website.create({name:"doorKeypad"+u,url:r+"/keypad.html#"+encodeURIComponent(u),position:{x:b.right*32,y:b.top*32,width:32*3,height:32*4},allowApi:!0})}function S(){s&&(WA.room.website.delete(s.name),s=void 0)}WA.room.onEnterLayer(o).subscribe(()=>{if(i=!0,t.getBoolean("autoOpen")&&l){WA.state[e.name]=!0;return}if(!WA.state[e.name]&&(f&&!l||!f)&&(t.getString("code")||t.getString("codeVariable"))){R(o);return}!l||(WA.state[e.name]?y():m())}),WA.room.onLeaveLayer(o).subscribe(()=>{i=!1,t.getBoolean("autoClose")&&(WA.state[e.name]=!1),a&&a.remove(),S()}),WA.state.onVariableChange(e.name).subscribe(()=>{i&&(!t.getBoolean("autoClose")&&WA.state[e.name]===!0&&y(),s&&WA.state[e.name]===!0&&S(),!t.getBoolean("autoOpen")&&WA.state[e.name]===!1&&m())})}function Ie(n){const e=n.properties.mustGetString("bellSound"),t=n.properties.getNumber("soundRadius");let r=1;if(t){const o=Math.sqrt(Math.pow(n.x-K,2)+Math.pow(n.y-_,2));if(o>t)return;r=1-o/t}WA.sound.loadSound(e).play({volume:r})}function Be(n){WA.state[n.name]===void 0&&(WA.state[n.name]=0),WA.state.onVariableChange(n.name).subscribe(()=>{WA.state[n.name]&&Ie(n)})}function Ge(n,e,t){let r;const o=e.getString("bellPopup");WA.room.onEnterLayer(t).subscribe(()=>{var a;o?r=WA.ui.openPopup(o,"",[{label:(a=e.getString("bellButtonText"))!==null&&a!==void 0?a:"Ring",callback:()=>{WA.state[n]=WA.state[n]+1}}]):WA.state[n]=WA.state[n]+1}),WA.room.onLeaveLayer(t).subscribe(()=>{r&&(r.close(),r=void 0)})}async function Ve(n){n=n!=null?n:D;const e=await ae();j=await M();for(const t of e.values())t.properties.get("door")&&ke(t),t.properties.get("bell")&&Be(t);for(const t of j.values()){const r=new L(t.properties),o=r.getString("doorVariable");if(o&&t.type==="tilelayer"){const s=e.get(o);if(s===void 0)throw new Error('Cannot find variable "'+o+'" referred in the "doorVariable" property of layer "'+t.name+'"');Re(t,s,r,n)}const a=r.getString("bellVariable");a&&Ge(a,r,t.name)}WA.player.onPlayerMove(t=>{K=t.x,_=t.y})}function xe(n,e){const t=n.getString("bindVariable");if(t){const r=n.get("enterValue"),o=n.get("leaveValue"),a=n.getString("triggerMessage"),s=n.getString("tag");Oe(t,e,r,o,a,s)}}function Oe(n,e,t,r,o,a){a&&!WA.player.tags.includes(a)||(t!==void 0&&WA.room.onEnterLayer(e).subscribe(()=>{o||(WA.state[n]=t)}),r!==void 0&&WA.room.onLeaveLayer(e).subscribe(()=>{WA.state[n]=r}))}async function je(){const n=await M();for(const e of n.values()){const t=new L(e.properties);xe(t,e.name)}}let X;async function De(n){const e=await WA.room.getTiledMap();n=n!=null?n:D,X=await M();const t=e.layers.find(r=>r.name==="configuration");if(t){const o=new L(t.properties).getString("tag");(!o||WA.player.tags.includes(o))&&WA.ui.registerMenuCommand("Configure the room",()=>{WA.nav.openCoWebSite(n+"/configuration.html",!0)});for(const a of X.values()){const s=new L(a.properties),i=s.getString("openConfig");i&&a.type==="tilelayer"&&Ue(i.split(","),a.name,s)}}}function Ue(n,e,t){let r;const o=t.getString("openConfigAdminTag");let a=!0;o&&!WA.player.tags.includes(o)&&(a=!1);function s(){var c;r&&r.remove(),r=WA.ui.displayActionMessage({message:(c=t.getString("openConfigTriggerMessage"))!==null&&c!==void 0?c:"Press SPACE or touch here to configure",callback:()=>N(n)})}function i(){WA.nav.closeCoWebSite()}WA.room.onEnterLayer(e).subscribe(()=>{const c=t.getString("openConfigTrigger");a&&(c&&c==="onaction"?s():N(n))}),WA.room.onLeaveLayer(e).subscribe(()=>{r&&r.remove(),i()})}function Ke(){return WA.onInit().then(()=>{Ve().catch(n=>console.error(n)),je().catch(n=>console.error(n)),De().catch(n=>console.error(n)),Le().catch(n=>console.error(n)),Pe().catch(n=>console.error(n))}).catch(n=>console.error(n))}console.log("Script started successfully");let A;WA.onInit().then(()=>{console.log("Scripting API ready"),console.log("Player tags: ",WA.player.tags);const n="Asking for a clue will add 2 minutes to your time. The game ends after 20 minutes.";let e=!1;WA.room.onEnterLayer("cigarette").subscribe(()=>{WA.state.CigaretteVisible&&(A=WA.ui.openPopup("cigarettePopup","A cigarette left on the ground. There is a trash can for that, but this person was obviously in a hurry.",[]),e=!0,WA.state.CigaretteVisible=!1)}),WA.room.onLeaveLayer("cigarette").subscribe(T),WA.room.area.onEnter("garbageCan").subscribe(()=>{e&&!WA.state.CigaretteComplete&&(A=WA.ui.openPopup("garbageCanPopup","You throw the cigarette in the garbage can. Thank you.",[]),WA.state.CigaretteComplete=!0)}),WA.room.area.onLeave("garbageCan").subscribe(T),WA.room.area.onEnter("info").subscribe(()=>{A=WA.ui.openPopup("infoPopup",`The goal is to enter all together in the train n\xB01 and to start it in order to escape!
The door can only be opened by the robot in front of the door if you complete all the riddles.`,[])}),WA.room.area.onLeave("info").subscribe(T),WA.room.area.onEnter("game").subscribe(()=>{A=WA.ui.openPopup("gamePopup","I'm playing Tic-tac-toe but I'm tired of playing against this robot. Can you try to win the game with circles?",[]),WA.state.TicTacToeStarted=!0}),WA.room.area.onLeave("game").subscribe(T),WA.room.onEnterLayer("tic-tac-toe").subscribe(()=>{WA.state.TicTacToeStarted&&(WA.state.TicTacToeOngoing=!0,WA.room.setProperty("tic-tac-toe","silent",!0))}),WA.room.onLeaveLayer("tic-tac-toe").subscribe(()=>{WA.state.TicTacToeComplete||(WA.state.TicTacToeOngoing=!1)}),WA.room.onEnterLayer("tic-tac-toe-play1").subscribe(()=>{WA.state.TicTacToeStarted&&(WA.state.TicTacToePlay1=!0,WA.state.TicTacToeComplete=WA.state.TicTacToePlay2)}),WA.room.onLeaveLayer("tic-tac-toe-play1").subscribe(()=>{WA.state.TicTacToeComplete||(WA.state.TicTacToePlay1=!1)}),WA.room.onEnterLayer("tic-tac-toe-play2").subscribe(()=>{WA.state.TicTacToeStarted&&(WA.state.TicTacToePlay2=!0,WA.state.TicTacToeComplete=WA.state.TicTacToePlay1)}),WA.room.onLeaveLayer("tic-tac-toe-play2").subscribe(()=>{WA.state.TicTacToeComplete||(WA.state.TicTacToePlay2=!1)}),WA.chat.onChatMessage(t=>{WA.state.QuestionOngoing&&(WA.state.QuestionComplete=t=="2018",WA.state.QuestionComplete?(WA.chat.sendChatMessage("Correct. You can now enter.","KindRobot000"),WA.state.TrainDoorOpen=!0):(WA.chat.sendChatMessage("Incorrect. You now have to start all over again.","KindRobot000"),WA.state.TicTacToeStarted=!1,WA.state.TicTacToeOngoing=!1,WA.state.TicTacToePlay1=!1,WA.state.TicTacToePlay2=!1,WA.state.TicTacToeComplete=!1,WA.state.CigaretteVisible=!0,e=!1,WA.state.CigaretteComplete=!1,WA.state.QuestionOngoing=!1,WA.state.QuestionComplete=!1,WA.state.TrainDoorOpen=!1))}),WA.room.area.onEnter("room1bot").subscribe(()=>{WA.state.QuestionComplete||(WA.state.TicTacToeComplete&&WA.state.CigaretteComplete?(WA.chat.sendChatMessage("Stranger, can you tell me in what year the train track switches were fully automated? Type your answer here.","KindRobot000"),WA.chat.sendChatMessage("Think carefully! If you make a mistake you will have to start all over again","KindRobot000"),WA.state.QuestionOngoing=!0):A=WA.ui.openPopup("room1botPopup","Stranger, I'll block the access to this train until you prove your worth. "+n,[{label:"Give me a clue",className:"primary",callback:()=>O(0)}]))}),WA.room.area.onLeave("room1bot").subscribe(T),WA.room.area.onEnter("goToDriverCabine").subscribe(()=>{WA.nav.goToRoom("map.json#driver-cabine");const t=137*32,r=16*32;WA.camera.set(t,r,500,500,!1,!0)}),WA.room.area.onEnter("room2bot").subscribe(()=>{A=WA.ui.openPopup("room2botPopup","Stranger, it seems this train is not going to start until you find the right key. "+n,[{label:"Give me a clue",className:"primary",callback:()=>O(1)}])}),WA.room.area.onLeave("room2bot").subscribe(T),WA.room.area.onEnter("room3bot").subscribe(()=>{A=WA.ui.openPopup("room3botPopup","Stranger, it seems your beloved Max Maulwurf is hangry. You will be blocked here until you comfort him. "+n,[{label:"Give me a clue",className:"primary",callback:()=>O(2)}])}),WA.room.area.onLeave("room3bot").subscribe(T),Ke().then(()=>{console.log("Scripting API Extra ready")}).catch(t=>console.error(t))}).catch(n=>console.error(n));function T(){A!==void 0&&(A.close(),A=void 0)}const Z=[["Message from the  Scripting API","1: Indice 2","1: Indice 3"],["2: Indice 1","2: Indice 2","2: Indice 3"],["3: Indice 1","3: Indice 2","3: Indice 3"]];let x=0;function O(n){Z[n][x]?(WA.chat.sendChatMessage(Z[n][x],"KindRobot00"+n),x++):WA.chat.sendChatMessage("Sorry. No more clues for this room.","KindRobot00"+n)}
